!function(a,e){function i(t,n){if("."!=t[0]&&"/"!=t[0])return a(t);n=n||"root";var e=i.resolve(t);if(!e&&/\.json$/i.test(t))return a("./"+i.basename(t));var r=i.cache[e];if(!r)try{return a(t)}catch(e){throw new Error('failed to require "'+t+'" from '+n+"\n"+e.message+"\n"+e.stack)}return r.exports||(r.exports={},r.call(r.exports,r,r.exports,i.relative(e))),r.exports}i.cache={},i.basename=a("path").basename,i.resolve=function(e){if("."!=e[0])return a.resolve(e);var t="/"===e.slice(-1)?e:e+"/",n=[e,e+".js",t+"index.js",e+".json",t+"index.json"];for(var r in n){var o=n[r];if(i.cache[o])return o}},i.register=function(e,t){i.cache[e]=t},i.relative=function(a){function e(e){if("."!=e[0])return i(e);var t=a.split("/"),n=e.split("/");for(var r in t.pop(),n){var o=n[r];".."==o?t.pop():"."!=o&&t.push(o)}return i(t.join("/"),a)}return e.resolve=i.resolve,e.cache=i.cache,e},i.register("./cli.js",function(e,t,n){"use strict";var r=c(n("./cli/Api")),o=c(n("commander")),a=c(n("readline")),i=c(n("util"));function c(e){return e&&e.__esModule?e:{default:e}}o.default.version("1.0.0").option("-l, --login <login>","login of your bitshares account").option("-p, --password  [password]","password of your bitshares account").option("-k, --privateKey [privateKey]","private key of your bitshares account").option("-u, --url <nodeUrl>","url of node to connect").parse(process.argv),o.default.password||o.default.privateKey||(console.log("Error: you must provide password or privateKey for accessing to your bitshares account"),process.exit());var u=a.default.createInterface({input:process.stdin,output:process.stdout}),s=">",d=function(e,t,n){console.log(i.default.inspect(t,!1,null)),u.setPrompt(s,s.length),u.prompt()};r.default.getPrograms(o.default.url,o.default.login,o.default.password,o.default.privateKey,d).then(function(i){function t(e,t){var n=t.split(" "),r=n[0],o=["",""].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n)),a=!1,i=!0,c=!1,u=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var f=s.value;try{r===f.name()&&(a=!0),f.parse(o)}catch(e){console.log(e)}}}catch(e){c=!0,u=e}finally{try{!i&&l.return&&l.return()}finally{if(c)throw u}}a||d(0,"Unknown command "+r)}i.push(new o.default.Command("help").action(function(e){if("help"===e){var t=!0,n=!1,r=void 0;try{for(var o,a=i[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){o.value.outputHelp(),console.log("\n--------------------------\n")}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}d(0,"")}})),i.push(new o.default.Command("exit").action(function(e){"exit"===e&&u.close()})),u.on("line",function(e){t(i,e.trim())}).on("close",function(){process.exit(0)}),u.setPrompt(s,s.length),u.prompt()}).catch(function(e){console.log(e)})}),i.register("./main.js",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("./api/Api");t.default=r.Api}),i.register("./apiApi.js",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Api=void 0;var r,o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),i=n("../common/Account"),c=n("./StudentApi"),u=n("./TeacherApi"),s=n("./BlockchainApi"),l=n("bitsharesjs"),f=n("../common/Configs"),a=n("request-promise"),d=(r=a)&&r.__esModule?r:{default:r};var h=function(){function a(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.account=new i.Account(e,t),this.studentApi=new c.StudentApi(this.account),this.teacherApi=new u.TeacherApi(this.account)}return o(a,null,[{key:"init",value:function(n,e,t){var r=new a(e,t);return new Promise(function(e,t){s.BlockchainApi.init(n).then(function(){return e(r)}).catch(t)})}},{key:"generateKeys",value:function(e,t){return l.Login.generateKeys(e,t)}}]),o(a,[{key:"setPrivateKey",value:function(e){this.account.setPrivateKey(e)}},{key:"register",value:function(r,o){return new Promise(function(t,n){var e=a.generateKeys(r,o);(0,d.default)({method:"POST",url:f.utSchoolFaucetAddress,body:{account:{active_key:e.pubKeys.active,memo_key:e.pubKeys.memo,owner_key:e.pubKeys.owner,name:r,referrer:f.utSchoolFaucet}},json:!0}).then(function(e){t(e)}).catch(function(e){n("Faucet "+f.utSchoolFaucetAddress+" failed. "+e)})})}}]),a}();t.Api=h}),i.register("./apiBitsharesApiExtends.js",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BitsharesApiExtends=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=n("bitsharesjs-ws"),c=n("bitsharesjs");var a=c.ChainTypes.object_type,i=parseInt(a.operation_history,10),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"_fetchHistory",value:function(s){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,f=arguments[2],e=arguments[3],d=this,t=arguments[4],h=arguments[5];return void 0===e&&(e="1."+i+".0"),void 0===t&&(t="1."+i+".0"),new Promise(function(c,u){o.Apis.instance().history_api().exec("get_account_history",[s.get("id"),e,l,t]).then(function(e){var t=!0,n=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;i.op[0]!=f&&void 0!==f||h.push(i)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}e.length==l?d._fetchHistory(s,l,f,void 0,e[0].id,h).then(c,u):c(h)})})}},{key:"fetchHistory",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,n=arguments[2],r=arguments[3],o=arguments[4],a=e;if(!c.ChainValidation.is_object_id(a)&&e.toJS&&(a=e.get("id")),c.ChainValidation.is_object_id(a)&&(e=c.ChainStore.objects_by_id.get(a))){var i=c.ChainTypes.operations[n];if(void 0!==n&&void 0===i)throw new Error("unknown operation: "+n);return this._fetchHistory(e,t,i,r,o,[])}}}]),e}();t.BitsharesApiExtends=u}),i.register("./apiBlockchainApi.js",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlockchainApi=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=n("bitsharesjs"),a=n("bitsharesjs-ws");var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"init",value:function(e){return new Promise(function(t,n){a.Apis.instance(e,!0).init_promise.then(function(e){Promise.all([(new o.TransactionBuilder).update_head_block(),o.ChainStore.init()]).then(function(){console.log("connected to:",e[0].network_name,"network"),t()}).catch(n)}).catch(n)})}}]),e}();t.BlockchainApi=i}),i.register("./apiStudentApi.js",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StudentApi=void 0;var r,p=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),v=n("bitsharesjs"),S=n("./BitsharesApiExtends"),y=n("../common/Configs"),a=n("assert"),_=(r=a)&&r.__esModule?r:{default:r};var i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.account=e,this.feeAsset="BTS"}return o(t,[{key:"applyForLecture",value:function(s){var l=this;return new Promise(function(c,u){(0,_.default)(null!==l.account.privateKey,"You must provide private key for executing this method"),Promise.all([(0,v.FetchChain)("getAccount",s),(0,v.FetchChain)("getAccount",l.account.name),(0,v.FetchChain)("getAsset",y.utSchoolTokenTicket),(0,v.FetchChain)("getAsset",l.feeAsset)]).then(function(e){var t=p(e,4),n=t[0],r=t[1],o=t[2],a=t[3];(0,_.default)(null!==n,"Invalid lecture account "+s),(0,_.default)(null!==r,"Invalid student account "+l.account.name),(0,_.default)(null!==o,"Invalid ticket token "+y.utSchoolTokenTicket),(0,_.default)(null!==a,"Invalid fee asset name "+l.feeAsset);var i=new v.TransactionBuilder;i.add_type_operation("transfer",{fee:{amount:0,asset_id:a.get("id")},from:n.get("id"),to:r.get("id"),amount:{asset_id:o.get("id"),amount:1}}),i.set_required_fees().then(function(){i.propose({fee_paying_account:r.get("id")}),i.set_required_fees().then(function(){i.add_signer(l.account.privateKey,l.account.privateKey.toPublicKey().toPublicKeyString()),i.broadcast().then(function(e){c(i.serialize())}).catch(u)}).catch(u)}).catch(u)}).catch(u)})}},{key:"getLectureStats",value:function(e){var h=this;return new Promise(function(k,f){var d=[y.utSchoolTokenTicket,y.utSchoolTokenSession,y.utSchoolTokenGrade];Promise.all([(0,v.FetchChain)("getAccount",e),(0,v.FetchChain)("getAccount",h.account.name),(0,v.FetchChain)("getAsset",d)]).then(function(e){var t=p(e,3),n=t[0],r=t[1],o=t[2];o=o.toJS(),(0,_.default)(null!==n,"Invalid lecture account "+n),(0,_.default)(null!==r,"Invalid student account "+h.account.name),(0,_.default)(null!==o[0],"Invalid ticket token "+d[0]),(0,_.default)(null!==o[1],"Invalid session token "+d[1]),(0,_.default)(null!==o[2],"Invalid grade token "+d[2]);var y=n.get("id"),m=r.get("id"),g=o[0].id,A=n.get("proposals").toJS(),b={},a=!0,i=!1,c=void 0;try{for(var u,s=o[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var l=u.value;b[l.id]={id:l.id,symbol:l.symbol,accepted:!1,requested:!1,balance:v.ChainStore.getAccountBalance(n,l.id)}}}catch(e){i=!0,c=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw c}}S.BitsharesApiExtends.fetchHistory(y,100,"transfer").then(function(e){var t=!0,n=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value.op[1];i.from===y&&i.to===m&&b[i.amount.asset_id]&&(b[i.amount.asset_id].accepted=!0)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}(0,v.FetchChain)("getObject",A).then(function(e){e=e.toJS();var t=-1,n=!0,r=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var c=a.value;if(t++,c){if(!(Date.parse(c.proposed_transaction.expiration)<new Date/1e3)){var u=c.proposed_transaction.operations,s=void 0,l=!0,f=!1,d=void 0;try{for(var h,p=u[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var v=h.value[1];if(v.amount&&v.from&&(v.amount.asset_id===g&&v.from===y&&v.to===m)){s=v;break}}}catch(e){f=!0,d=e}finally{try{!l&&p.return&&p.return()}finally{if(f)throw d}}if(s){b[g].requested=!0;break}}}else console.log("Have no information about proposal "+A[t])}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}k(b)}).catch(f)}).catch(f)}).catch(f)})}},{key:"getLectures",value:function(){var b=this,k=[];return new Promise(function(g,A){Promise.all([(0,v.FetchChain)("getAccount",y.utSchoolAccount),(0,v.FetchChain)("getAsset",y.utSchoolToken)]).then(function(e){var t=p(e,2),c=t[0],s=t[1];(0,_.default)(null!==c,"Invalid utSchoolAccount "+y.utSchoolAccount),(0,_.default)(null!==s,"Invalid utSchoolToken "+y.utSchoolToken),c=c.get("id"),s=s.get("id"),S.BitsharesApiExtends.fetchHistory(c,100,"transfer").then(function(e){var u=[],t=!0,n=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value.op[1];i.from===c&&i.amount.asset_id===s&&u.push(i.to)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}0!==u.length?(0,v.FetchChain)("getAccount",u).then(function(e){e=e.toJS();var m=[],t=-1,n=!0,r=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var c=a.value;t++,c?(k.push({id:c.id,name:c.name,teacher:{id:c.active.account_auths[0][0]}}),m.push(c.active.account_auths[0][0])):console.log("Have no information about lecture with id "+u[t])}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}(0,v.FetchChain)("getAccount",m).then(function(e){var t={},n=-1;e=e.toJS();var r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var u=i.value;n++,u?t[u.id]=u:console.log("Have no information about teacher with id "+m[n])}}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}var s=[],l=!0,f=!1,d=void 0;try{for(var h,p=k[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var v=h.value,y=t[v.teacher.id];y&&(v.teacher.name=y.name),s.push(b.getLectureStats(v.name))}}catch(e){f=!0,d=e}finally{try{!l&&p.return&&p.return()}finally{if(f)throw d}}Promise.all(s).then(function(e){for(var t=0;t<k.length;t++)k[t].stats=e[t];g(k)}).catch(A)}).catch(A)}).catch(A):g(k)}).catch(A)}).catch(A)})}}]),t}();t.StudentApi=i}),i.register("./apiTeacherApi.js",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TeacherApi=void 0;var r,h=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_=n("bitsharesjs"),a=n("./BitsharesApiExtends"),i=n("../common/Configs"),c=n("assert"),p=(r=c)&&r.__esModule?r:{default:r};var u=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.account=e,this.feeAsset="BTS"}return o(t,[{key:"_sendToken",value:function(s,l,f){var d=this;return new Promise(function(c,u){(0,p.default)(null!==d.account.privateKey,"You must provide private key for executing this method"),Promise.all([(0,_.FetchChain)("getAccount",s),(0,_.FetchChain)("getAccount",l),(0,_.FetchChain)("getAsset",f),(0,_.FetchChain)("getAsset",d.feeAsset)]).then(function(e){var t=h(e,4),n=t[0],r=t[1],o=t[2],a=t[3];(0,p.default)(null!==n,"Invalid lecture account "+s),(0,p.default)(null!==r,"Invalid student account "+l),(0,p.default)(null!==o,"Invalid education token "+f),(0,p.default)(null!==a,"Invalid fee asset "+d.feeAsset);var i=new _.TransactionBuilder;i.add_type_operation("transfer",{fee:{amount:0,asset_id:a.get("id")},from:n.get("id"),to:r.get("id"),amount:{asset_id:o.get("id"),amount:1}}),i.set_required_fees().then(function(){i.add_signer(d.account.privateKey,d.account.privateKey.toPublicKey().toPublicKeyString()),i.broadcast().then(function(e){c(i.serialize())}).catch(u)}).catch(u)}).catch(u)})}},{key:"sendSessionToken",value:function(e,t){return this._sendToken(e,t,i.utSchoolTokenSession)}},{key:"sendGradeToken",value:function(e,t){return this._sendToken(e,t,i.utSchoolTokenGrade)}},{key:"getLectureParticipants",value:function(o){return new Promise(function(k,S){var r=[i.utSchoolTokenTicket,i.utSchoolTokenSession,i.utSchoolTokenGrade];Promise.all([(0,_.FetchChain)("getAccount",o),(0,_.FetchChain)("getAsset",r)]).then(function(e){var t=h(e,2),n=t[0],v=t[1];v=v.toJS(),(0,p.default)(null!==n,"Invalid lecture account "+o),(0,p.default)(null!==v[0],"Invalid ticket token "+r[0]),(0,p.default)(null!==v[1],"Invalid session token "+r[1]),(0,p.default)(null!==v[2],"Invalid grade token "+r[2]);var m=n.get("id"),g={},A=v.map(function(e){return e.id}),b=v[0].id;a.BitsharesApiExtends.fetchHistory(m,100,"transfer").then(function(e){var y=[],t=!0,n=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value.op[1];if(i.from===m){if(-1===A.indexOf(i.amount.asset_id))continue;var c=i.amount.asset_id;if(c===b&&y.push(i.to),-1!==A.indexOf(c)){var u=g[i.to];if(!u){g[i.to]=u={};var s=!0,l=!1,f=void 0;try{for(var d,h=v[Symbol.iterator]();!(s=(d=h.next()).done);s=!0){var p=d.value;u[p.id]={id:p.id,symbol:p.symbol,accepted:!1}}}catch(e){l=!0,f=e}finally{try{!s&&h.return&&h.return()}finally{if(l)throw f}}}u[c].accepted=!0}}}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}(0,_.FetchChain)("getAccount",y).then(function(e){e=e.toJS();var t={},n=-1,r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var u=i.value;n++,u?t[u.id]=u:console.log("Have no information about account "+s[n])}}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}var s=[],l=!0,f=!1,d=void 0;try{for(var h,p=y[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var v=t[h.value];v&&s.push({id:v.id,name:v.name,stats:g[v.id]})}}catch(e){f=!0,d=e}finally{try{!l&&p.return&&p.return()}finally{if(f)throw d}}k(s)}).catch(S)}).catch(S)}).catch(S)})}},{key:"getLectureApplications",value:function(r){return new Promise(function(k,S){Promise.all([(0,_.FetchChain)("getAccount",r),(0,_.FetchChain)("getAsset",i.utSchoolTokenTicket)]).then(function(e){var t=h(e,2),n=t[0],y=t[1];(0,p.default)(null!==n,"Invalid lecture account "+r),(0,p.default)(null!==y,"Invalid ticket token "+i.utSchoolTokenTicket);var g=n.get("id");y=y.get("id");var A=n.toJS().proposals;if(0!==A.length){var b=[];(0,_.FetchChain)("getObject",A).then(function(e){e=e.toJS();var m=[],t=-1,n=!0,r=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var c=a.value;if(t++,c){if(!(Date.parse(c.proposed_transaction.expiration)<new Date/1e3)){var u=c.proposed_transaction.operations,s=void 0,l=!0,f=!1,d=void 0;try{for(var h,p=u[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var v=h.value[1];if(v.amount&&v.from&&(v.amount.asset_id===y&&v.from===g)){s=v;break}}}catch(e){f=!0,d=e}finally{try{!l&&p.return&&p.return()}finally{if(f)throw d}}s&&(m.push(s.to),b.push({id:c.id,operation:s}))}}else console.log("Have no information about proposal "+A[t])}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}0!==b.length?(0,_.FetchChain)("getAccount",m).then(function(e){e=e.toJS();var t={},n=-1,r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var u=i.value,s=m[++n];u||(console.log("Have no information about account "+s),u={id:s}),t[s]=u}}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}var l=!0,f=!1,d=void 0;try{for(var h,p=b[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var v=h.value,y=t[v.operation.to];delete v.operation,v.account={id:y.id,name:y.name}}}catch(e){f=!0,d=e}finally{try{!l&&p.return&&p.return()}finally{if(f)throw d}}k(b)}).catch(S):k([])}).catch(S)}else k([])}).catch(S)})}},{key:"acceptApplication",value:function(c){var u=this;return new Promise(function(a,i){(0,p.default)(null!==u.account.privateKey,"You must provide private key for executing this method"),Promise.all([(0,_.FetchChain)("getAccount",u.account.name),(0,_.FetchChain)("getAsset",u.feeAsset)]).then(function(e){var t=h(e,3),n=t[0],r=t[1];t[2];(0,p.default)(null!==n,"Invalid teacher account "+u.account.name),(0,p.default)(null!==r,"Invalid fee asset "+u.feeAsset);var o=new _.TransactionBuilder;o.add_type_operation("proposal_update",{fee:{amount:0,asset_id:r.get("id")},fee_paying_account:n.get("id"),proposal:c,active_approvals_to_add:[n.get("id")]}),o.set_required_fees().then(function(){o.add_signer(u.account.privateKey,u.account.privateKey.toPublicKey().toPublicKeyString()),o.broadcast().then(function(e){a(o.serialize())}).catch(i)}).catch(i)}).catch(i)})}},{key:"getLectureStats",value:function(e){return Promise.all([this.getLectureParticipants(e),this.getLectureApplications(e)])}},{key:"__processLectureQueue",value:function(o,a,i){var c=this;a>=o.length?i(o):this.getLectureStats(o[a].name).then(function(e){var t=h(e,2),n=t[0],r=t[1];o[a].participants=n,o[a].applications=r,c.__processLectureQueue(o,a+1,i)})}},{key:"getLectures",value:function(){var A=this;return new Promise(function(g,s){Promise.all([(0,_.FetchChain)("getAccount",i.utSchoolAccount),(0,_.FetchChain)("getAccount",A.account.name),(0,_.FetchChain)("getAsset",i.utSchoolToken)]).then(function(e){var t=h(e,3),c=t[0],m=t[1],u=t[2];(0,p.default)(null!==c,"Invalid utSchoolAccount "+i.utSchoolAccount),(0,p.default)(null!==m,"Invalid teacher account "+A.account.name),(0,p.default)(null!==u,"Invalid utSchoolToken "+i.utSchoolToken),c=c.get("id"),m=m.get("id"),u=u.get("id"),a.BitsharesApiExtends.fetchHistory(c,100,"transfer").then(function(e){var y=[],t=!0,n=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value.op[1];i.from===c&&i.amount.asset_id===u&&y.push(i.to)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}0!==y.length?(0,_.FetchChain)("getAccount",y).then(function(e){e=e.toJS();var t=[],n=-1,r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var u=i.value;if(n++,u){var s=u.active.account_auths;if(0!==s.length&&0!==s[0].length){var l=s[0],f=!0,d=!1,h=void 0;try{for(var p,v=l[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){if(p.value===m){t.push({id:u.id,name:u.name});break}}}catch(e){d=!0,h=e}finally{try{!f&&v.return&&v.return()}finally{if(d)throw h}}}}else console.log("Have no information about lecture "+y[n])}}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}0!==t.length?A.__processLectureQueue(t,0,g):g([])}).catch(s):g([])}).catch(s)}).catch(s)})}}]),t}();t.TeacherApi=u}),i.register("./cliApi.js",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o,i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),c=a(n("./StudentApi")),u=a(n("./TeacherApi")),s=n("../api/Api"),l=n("./ProgramsGenerator");function a(e){return e&&e.__esModule?e:{default:e}}function f(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var d=(o=r=function(){function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}return i(a,null,[{key:"getPrograms",value:function(e,t,n,r,o){return s.Api.init(e,t,r).then(function(e){return r||(r=s.Api.generateKeys(t,n).privKeys.active,e.account.privateKey=r),[].concat(f((0,l.generatePrograms)(a.programs,e,o)),f((0,l.generatePrograms)(c.default.programs,e.studentApi,o)),f((0,l.generatePrograms)(u.default.programs,e.teacherApi,o)))})}}]),a}(),r.programs=[{command:{name:"setPrivateKey",description:"set private key of current user"},options:[{key:"privateKey",name:"-p, --privateKey <privateKey>",description:"private key",required:!0}],exec:"setPrivateKey"},{command:{name:"register",description:"register user by login, password"},options:[{key:"login",name:"-l, --login <login>",description:"name of the new bitshares account",required:!0},{key:"password",name:"-p, --password <password>",description:"password for generating bitshares keys",required:!0}],exec:"register"}],o);t.default=d}),i.register("./cliProgramsGenerator.js",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generatePrograms=void 0;var r,o=n("commander"),s=(r=o)&&r.__esModule?r:{default:r};t.generatePrograms=function(e,f,d){var c=[],t=!0,n=!1,r=void 0;try{for(var u,o=function(){var l=u.value,e=new s.default.Command(l.command.name);e.description(l.command.description);var t=!0,n=!1,r=void 0;try{for(var o,a=l.options[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;e.option(i.name,i.description)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}e.action(function(t,e){if(t===l.command.name){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=l.options[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var u=i.value,s=e[u.key];if(null==s&&u.required)return void d(t,"Option "+u.name+" is required for method "+t,!0);n.push(s)}}catch(e){o=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw a}}f[l.exec].apply(f,n).then(function(e){d(t,e,!1)}).catch(function(e){d(t,e,!0)})}}),c.push(e)},a=e[Symbol.iterator]();!(t=(u=a.next()).done);t=!0)o()}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return c}}),i.register("./cliStudentApi.js",function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0});var a=(o=r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},r.programs=[{command:{name:"studentApi.applyForLecture",description:"apply current user for the lecture"},options:[{key:"lectureAccount",name:"-l, --lectureAccount <lectureAccount>",description:"name of the bitshares lecture account",required:!0}],exec:"applyForLecture"},{command:{name:"studentApi.getLectureStats",description:"collect information about lecture"},options:[{key:"lectureAccount",name:"-l, --lectureAccount <lectureAccount>",description:"name of the bitshares lecture account",required:!0}],exec:"getLectureStats"},{command:{name:"studentApi.getLectures",description:"return all available lectures for current user"},options:[],exec:"getLectures"}],o);t.default=a}),i.register("./cliTeacherApi.js",function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0});var a=(o=r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},r.programs=[{command:{name:"teacherApi.sendSessionToken",description:"send session token from lecture account to particular student"},options:[{key:"lectureAccount",name:"-l, --lectureAccount <lectureAccount>",description:"name of the bitshares lecture account",required:!0},{key:"studentAccount",name:"-s, --studentAccount <studentAccount>",description:"name of the bitshares student account",required:!0}],exec:"sendSessionToken"},{command:{name:"teacherApi.sendGradeToken",description:"send grade token from lecture account to particular student"},options:[{key:"lectureAccount",name:"-l, --lectureAccount <lectureAccount>",description:"name of the bitshares lecture account",required:!0},{key:"studentAccount",name:"-s, --studentAccount <studentAccount>",description:"name of the bitshares student account",required:!0}],exec:"sendGradeToken"},{command:{name:"teacherApi.getLectureParticipants",description:"fetch from blockchain information about participants of the lecture"},options:[{key:"lectureAccount",name:"-l, --lectureAccount <lectureAccount>",description:"name of the bitshares lecture account",required:!0}],exec:"getLectureParticipants"},{command:{name:"teacherApi.getLectureApplications",description:"fetch from blockchain information about applications for the lecture"},options:[{key:"lectureAccount",name:"-l, --lectureAccount <lectureAccount>",description:"name of the bitshares lecture account",required:!0}],exec:"getLectureApplications"},{command:{name:"teacherApi.acceptApplication",description:"accept proposal for application for the lecture"},options:[{key:"lectureApplicationId",name:"-i, --lectureApplicationId <lectureApplicationId>",description:"id of the proposal for application for the lecture",required:!0}],exec:"acceptApplication"},{command:{name:"teacherApi.getLectureStats",description:"return statistics about particular lecture"},options:[{key:"lectureAccount",name:"-l, --lectureAccount <lectureAccount>",description:"name of the bitshares lecture account",required:!0}],exec:"getLectureStats"},{command:{name:"teacherApi.getLectures",description:"collect all lectures of the current user"},options:[],exec:"getLectures"}],o);t.default=a}),i.register("./commonAccount.js",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Account=void 0;var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),o=n("bitsharesjs");n("bs58");var a=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.name=e,this.setPrivateKey(t)}return r(n,[{key:"setPrivateKey",value:function(e){this.privateKey=e?o.PrivateKey.fromWif(e):null}}]),n}();t.Account=a}),i.register("./commonConfigs.js",function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="UTSCHOOL";t.utSchoolToken=r,t.utSchoolTokenTicket="UTSCHOOL.TICKET",t.utSchoolTokenSession="UTSCHOOL.SESSION",t.utSchoolTokenGrade="UTSCHOOL.GRADE",t.utSchoolAccount="ut-school",t.utSchoolFaucetAddress="https://transnet.tech:10443/api/v1/accounts",t.utSchoolFaucet="u-tech-faucet"}),e.exports=i("./main.js")}(require,module);
//# sourceMappingURL=app.min.js.map
